TODO :: 1) complete logic for transaction control
